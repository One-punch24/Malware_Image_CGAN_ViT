import os
import shutil
 
 
source = "C:\\"
dist   = "binary"
cnt = 1

for root, dirs, files in os.walk(source):
    for file in files:
        if file.endswith(".exe") or file.endswith(".dll"):
            q = os.path.join(root, file)
            if os.path.exists(q) and os.path.getsize(q) > 100*1024 and os.path.getsize(q) < 3000*1024:
                try:
                    shutil.copy2(q , dist)
                    print(str(cnt))
                    cnt += 1
                except Exception or FileNotFoundError:
                    print("permission denied")
                    pass
