# Malware_Markov_Image_CGAN_ViT

We are intended to implement the malware detection ViT with construction of high order Markov image. Thanks to [ViT-pytorch](https://github.com/jeonsworld/ViT-pytorch), we are able to utilize the concise code while we add clear annotations for the implementation of ViT, especially focusing on the vicissitude of structure dimension.

## Preparation

### 1. Download Pre-trained model

* [Available models](https://console.cloud.google.com/storage/vit_models/): ViT-B_16(**85.8M**), R50+ViT-B_16(**97.96M**), ViT-B_32(**87.5M**), ViT-L_16(**303.4M**), ViT-L_32(**305.5M**), ViT-H_14(**630.8M**)
  * imagenet21k pre-train models
    * ViT-B_16, ViT-B_32, ViT-L_16, ViT-L_32, ViT-H_14

We simply use ViT-B_16.

### 2. Download Malevis Dataset

+ [MaleVis Dataset](https://web.cs.hacettepe.edu.tr/~selman/malevis/)

## Run

### 1 Train

```
python train.py --test False --dataset_dir xxxxx 
```

### 2 Test

```
python train.py --test True --dataset_dir xxxxx 
```

## Reference

[ViT-pytorch](https://github.com/jeonsworld/ViT-pytorch)

## Citation

```bibtex
@article{dosovitskiy2020,
  title={An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale},
  author={Dosovitskiy, Alexey and Beyer, Lucas and Kolesnikov, Alexander and Weissenborn, Dirk and Zhai, Xiaohua and Unterthiner, Thomas and  Dehghani, Mostafa and Minderer, Matthias and Heigold, Georg and Gelly, Sylvain and Uszkoreit, Jakob and Houlsby, Neil},
  journal={arXiv preprint arXiv:2010.11929},
  year={2020}
}
```

```bibtex
@inproceedings{inproceedings,
author = {Bozkir, Ahmet and Cankaya, Ahmet and Aydos, Murat},
year = {2019},
month = {03},
pages = {},
title = {Utilization and Comparision of Convolutional Neural Networks in Malware Recognition},
doi = {10.1109/SIU.2019.8806511}
}
```

